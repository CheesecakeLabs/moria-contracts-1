{"version":3,"sources":["../../app/javascripts/app.js"],"names":["require","MoriaToken","accounts","account","window","App","start","self","setProvider","web3","currentProvider","eth","getAccounts","err","accs","alert","length","refreshBalance","setStatus","message","status","document","getElementById","innerHTML","token","decimals","deployed","then","instance","value","balanceOf","call","from","balance_element","balance","valueOf","Math","pow","catch","e","console","log","sendCoin","amount","parseInt","receiver","realAmount","transfer","addEventListener","warn","process","env","RPC","providers","HttpProvider","$","hide","show","click","preventDefault","$this","tabgroup","parents","data","others","closest","siblings","children","target","attr","removeClass","addClass"],"mappings":";;AAIA;;;;AACA;;;;AAMA;;;;;;AAXA;AACA;;AAEA;AAIAA,QAAQ,qBAAR;AACAA,QAAQ,mCAAR;;AAEA;;;AAGA,IAAIC,aAAa,oDAAjB;;AAEA;AACA;AACA;AACA,IAAIC,QAAJ;AACA,IAAIC,OAAJ;;AAEAC,OAAOC,GAAP,GAAa;AACXC,SAAO,iBAAW;AAChB,QAAIC,OAAO,IAAX;;AAEA;AACAN,eAAWO,WAAX,CAAuBC,KAAKC,eAA5B;;AAEA;AACAD,SAAKE,GAAL,CAASC,WAAT,CAAqB,UAASC,GAAT,EAAcC,IAAd,EAAoB;AACvC,UAAID,OAAO,IAAX,EAAiB;AACfE,cAAM,4CAAN;AACA;AACD;;AAED,UAAID,KAAKE,MAAL,IAAe,CAAnB,EAAsB;AACpBD,cAAM,oFAAN;AACA;AACD;;AAEDb,iBAAWY,IAAX;AACAX,gBAAUD,SAAS,CAAT,CAAV;;AAEAK,WAAKU,cAAL;AACD,KAfD;AAgBD,GAxBU;;AA0BXC,aAAW,mBAASC,OAAT,EAAkB;AAC3B,QAAIC,SAASC,SAASC,cAAT,CAAwB,QAAxB,CAAb;AACAF,WAAOG,SAAP,GAAmBJ,OAAnB;AACD,GA7BU;;AA+BXF,kBAAgB,0BAAW;AACzB,QAAIV,OAAO,IAAX;;AAEA,QAAIiB,KAAJ;AACA,QAAIC,QAAJ;AACAxB,eAAWyB,QAAX,GAAsBC,IAAtB,CAA2B,UAASC,QAAT,EAAmB;AAC5CJ,cAAQI,QAAR;AACA,aAAOJ,MAAMC,QAAN,EAAP;AACD,KAHD,EAGGE,IAHH,CAGQ,UAASE,KAAT,EAAgB;AACtBJ,iBAAWI,KAAX;AACA,aAAOL,MAAMM,SAAN,CAAgBC,IAAhB,CAAqB5B,OAArB,EAA8B,EAAC6B,MAAM7B,OAAP,EAA9B,CAAP;AACD,KAND,EAMGwB,IANH,CAMQ,UAASE,KAAT,EAAgB;AACtB,UAAII,kBAAkBZ,SAASC,cAAT,CAAwB,SAAxB,CAAtB;AACA,UAAIY,UAAUL,MAAMM,OAAN,KAAmBC,KAAKC,GAAL,CAAS,EAAT,EAAaZ,QAAb,CAAjC;AACAQ,sBAAgBV,SAAhB,GAA4BW,OAA5B;AACD,KAVD,EAUGI,KAVH,CAUS,UAASC,CAAT,EAAY;AACnBC,cAAQC,GAAR,CAAYF,CAAZ;AACAhC,WAAKW,SAAL,CAAe,iCAAf;AACD,KAbD;AAcD,GAlDU;;AAoDXwB,YAAU,oBAAW;AACnB,QAAInC,OAAO,IAAX;;AAEA,QAAIoC,SAASC,SAASvB,SAASC,cAAT,CAAwB,QAAxB,EAAkCO,KAA3C,CAAb;AACA,QAAIgB,WAAWxB,SAASC,cAAT,CAAwB,UAAxB,EAAoCO,KAAnD;;AAEA,SAAKX,SAAL,CAAe,yCAAf;;AAEA,QAAIM,KAAJ;AACA,QAAIC,QAAJ;AACAxB,eAAWyB,QAAX,GAAsBC,IAAtB,CAA2B,UAASC,QAAT,EAAmB;AAC5CJ,cAAQI,QAAR;AACA,aAAOJ,MAAMC,QAAN,EAAP;AACD,KAHD,EAGGE,IAHH,CAGQ,UAASE,KAAT,EAAgB;AACtBJ,iBAAWI,KAAX;AACA,UAAIiB,aAAaH,SAASP,KAAKC,GAAL,CAAS,EAAT,EAAaZ,QAAb,CAA1B;AACA,aAAOD,MAAMuB,QAAN,CAAeF,QAAf,EAAyBC,UAAzB,EAAqC,EAACd,MAAM7B,OAAP,EAArC,CAAP;AACD,KAPD,EAOGwB,IAPH,CAOQ,UAASP,MAAT,EAAiB;AACvBb,WAAKW,SAAL,CAAe,sBAAf;AACAX,WAAKU,cAAL;AACD,KAVD,EAUGqB,KAVH,CAUS,UAASC,CAAT,EAAY;AACnBC,cAAQC,GAAR,CAAYF,CAAZ;AACAhC,WAAKW,SAAL,CAAe,8BAAf;AACD,KAbD;AAcD;AA5EU,CAAb;;AA+EAd,OAAO4C,gBAAP,CAAwB,MAAxB,EAAgC,YAAW;AACzC;AACA,MAAI,OAAOvC,IAAP,KAAgB,WAApB,EAAiC;AAC/B+B,YAAQS,IAAR,CAAa,ySAAb;AACA;AACA7C,WAAOK,IAAP,GAAc,kBAASA,KAAKC,eAAd,CAAd;AACD,GAJD,MAIO;AACL8B,YAAQS,IAAR,CAAa,wQAAb;AACA;;AAEAT,YAAQC,GAAR,CAAY,oBAAoBS,QAAQC,GAAR,CAAYC,GAA5C;AACAhD,WAAOK,IAAP,GAAc,kBAAS,IAAI,cAAK4C,SAAL,CAAeC,YAAnB,CAAgC,sBAAsBJ,QAAQC,GAAR,CAAYC,GAAlE,CAAT,CAAd;AACD;AACDG,IAAE,iBAAF,EAAqBC,IAArB;AACAD,IAAE,+BAAF,EAAmCE,IAAnC;AACAF,IAAE,SAAF,EAAaG,KAAb,CAAmB,UAASnB,CAAT,EAAW;AAC5BA,MAAEoB,cAAF;AACA,QAAIC,QAAQL,EAAE,IAAF,CAAZ;AAAA,QACIM,WAAW,MAAID,MAAME,OAAN,CAAc,OAAd,EAAuBC,IAAvB,CAA4B,UAA5B,CADnB;AAAA,QAEIC,SAASJ,MAAMK,OAAN,CAAc,IAAd,EAAoBC,QAApB,GAA+BC,QAA/B,CAAwC,GAAxC,CAFb;AAAA,QAGIC,SAASR,MAAMS,IAAN,CAAW,MAAX,CAHb;AAIAL,WAAOM,WAAP,CAAmB,QAAnB;AACAV,UAAMW,QAAN,CAAe,QAAf;AACAhB,MAAEM,QAAF,EAAYM,QAAZ,CAAqB,KAArB,EAA4BX,IAA5B;AACAD,MAAEa,MAAF,EAAUX,IAAV;AAED,GAXD;;AAaApD,MAAIC,KAAJ;AACD,CA7BD","file":"app.js","sourcesContent":["// Import the page's CSS. Webpack will know what to do with it.\n//import aceCss from 'ace-css/css/ace.min.css'\n\n// Import libraries we need.\nimport { default as Web3} from 'web3';\nimport { default as contract } from 'truffle-contract'\n\nrequire('ace-css/css/ace.css');\nrequire('font-awesome/css/font-awesome.css');\n\n// Import our contract artifacts and turn them into usable abstractions.\nimport MoriaTokenSol from '../../contracts/MoriaToken.sol'\n\nvar MoriaToken = contract(MoriaTokenSol);\n\n// The following code is simple to show off interacting with your contracts.\n// As your needs grow you will likely need to change its form and structure.\n// For application bootstrapping, check out window.addEventListener below.\nvar accounts;\nvar account;\n\nwindow.App = {\n  start: function() {\n    var self = this;\n\n    // Bootstrap the MoriaToken abstraction for Use.\n    MoriaToken.setProvider(web3.currentProvider);\n\n    // Get the initial account balance so it can be displayed.\n    web3.eth.getAccounts(function(err, accs) {\n      if (err != null) {\n        alert(\"There was an error fetching your accounts.\");\n        return;\n      }\n\n      if (accs.length == 0) {\n        alert(\"Couldn't get any accounts! Make sure your Ethereum client is configured correctly.\");\n        return;\n      }\n\n      accounts = accs;\n      account = accounts[0];\n\n      self.refreshBalance();\n    });\n  },\n\n  setStatus: function(message) {\n    var status = document.getElementById(\"status\");\n    status.innerHTML = message;\n  },\n\n  refreshBalance: function() {\n    var self = this;\n\n    var token;\n    var decimals;\n    MoriaToken.deployed().then(function(instance) {\n      token = instance;\n      return token.decimals();\n    }).then(function(value) {\n      decimals = value;\n      return token.balanceOf.call(account, {from: account});\n    }).then(function(value) {\n      var balance_element = document.getElementById(\"balance\");\n      var balance = value.valueOf() / (Math.pow(10, decimals));\n      balance_element.innerHTML = balance;\n    }).catch(function(e) {\n      console.log(e);\n      self.setStatus(\"Error getting balance; see log.\");\n    });\n  },\n\n  sendCoin: function() {\n    var self = this;\n\n    var amount = parseInt(document.getElementById(\"amount\").value);\n    var receiver = document.getElementById(\"receiver\").value;\n    \n    this.setStatus(\"Initiating transaction... (please wait)\");\n\n    var token;\n    var decimals;\n    MoriaToken.deployed().then(function(instance) {\n      token = instance;\n      return token.decimals();\n    }).then(function(value) {\n      decimals = value;\n      var realAmount = amount * Math.pow(10, decimals);\n      return token.transfer(receiver, realAmount, {from: account});\n    }).then(function(status) {\n      self.setStatus(\"Transaction complete\");\n      self.refreshBalance();\n    }).catch(function(e) {\n      console.log(e);\n      self.setStatus(\"Error sending coin; see log.\");\n    });\n  }\n};\n\nwindow.addEventListener('load', function() {\n  // Checking if Web3 has been injected by the browser (Mist/MetaMask)\n  if (typeof web3 !== 'undefined') {\n    console.warn(\"Using web3 detected from external source. If you find that your accounts don't appear or you have 0 MetaCoin, ensure you've configured that source properly. If using MetaMask, see the following link. Feel free to delete this warning. :) http://truffleframework.com/tutorials/truffle-and-metamask\")\n    // Use Mist/MetaMask's provider\n    window.web3 = new Web3(web3.currentProvider);\n  } else {\n    console.warn(\"No web3 detected. Falling back to http://localhost:8545. You should remove this fallback when you deploy live, as it's inherently insecure. Consider switching to Metamask for development. More info here: http://truffleframework.com/tutorials/truffle-and-metamask\");\n    // fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)\n\n    console.log(\"RPCPORT set as \" + process.env.RPC)\n    window.web3 = new Web3(new Web3.providers.HttpProvider(\"http://localhost:\" + process.env.RPC));\n  }\n  $('.tabgroup > div').hide();\n  $('.tabgroup > div:first-of-type').show();\n  $('.tabs a').click(function(e){\n    e.preventDefault();\n    var $this = $(this),\n        tabgroup = '#'+$this.parents('.tabs').data('tabgroup'),\n        others = $this.closest('li').siblings().children('a'),\n        target = $this.attr('href');\n    others.removeClass('active');\n    $this.addClass('active');\n    $(tabgroup).children('div').hide();\n    $(target).show();\n    \n  })\n  \n  App.start();\n});\n"]}