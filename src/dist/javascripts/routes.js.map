{"version":3,"sources":["../../app/javascripts/routes.js"],"names":["request","require","express","bodyParser","app","use","urlencoded","extended","json","api","init","get","req","res","send","getBalance","params","then","result","getTotalTokens","getOutstandingDividends","payOutstandingDividends","value","console","log","post","body","address","callback","created","Date","now","completed","error","response","statusCode","amount","mintTokens","minted","listen"],"mappings":"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","file":"routes.js","sourcesContent":["const request = require('request');\nconst express = require('express')\nconst bodyParser = require('body-parser');\nconst app = express()\n\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(bodyParser.json())\n\nvar api = require(\"./api.js\")\napi.init();\n\napp.get('/', (req, res) => res.send('Hello World!'))\n\napp.get('/api/balance/:address', (req, res) => \n        api.getBalance(req.params[\"address\"]).then(function(result) {\n          res.send({\"total\" : result});\n        }));\n\napp.get('/api/total', (req, res) => \n        api.getTotalTokens().then(function(result) {\n          res.send({\"total\" : result});          \n        }));\n\napp.get('/api/dividends/:address', (req, res) =>\n        api.getOutstandingDividends(req.params[\"address\"]).then(function(result) {\n          res.send({\"owed\" : result});\n        }));\n\napp.get('/api/pay/:address', (req, res) =>\n        api.payOutstandingDividends(req.params[\"address\"], function (value) {console.log(value);} ).then(function(result) {\n          res.send(result);\n        }));\n\napp.post('/api/pay/', (req, res) => {\n  var params = req.body;\n  var address = params['address'];\n  var callback = params['callback'];\n  var created = Date.now;\n  var completed = 0;\n\n  api.payOutstandingDividends(address, function(value) {\n    console.log(value);\n    completed = Date.now;\n  }).then(function(result) {\n    request.post(address,\n                 {json: {\"success\" : value,\n                         \"completed\" : completed,\n                         \"created\" : created}},\n                 function (error, response, body) {\n                   if (!error && response.statusCode == 200) {\n                     console.log(body)\n                   }\n                 });\n  })});\n\n\napp.get('/api/mint/:address/:amount', (req, res) => {\n  var address = req.params[\"address\"];\n  var amount = req.params[\"amount\"];\n  api.mintTokens(address, amount, function (minted) {\n    console.log(\"minted = \" + minted)}).then(function(result) {\n      res.send(result);\n    })});\n\napp.post('/test/callback', (req, res) => {\n  console.log(req.body);\n  res.send(req.body[\"poo\"]);\n});\n\napp.post('/api/mint/:address/:amount', (req, res) => {});\n\napp.listen(3000, () => console.log('API active on port 3000!'))\n"]}